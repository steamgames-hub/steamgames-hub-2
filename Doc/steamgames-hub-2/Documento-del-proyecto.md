# Steamgames-hub-2

- **Grupo:** 3 (tarde)
- **Curso escolar:** 2025/2026
- **Asignatura:** Evolución y gestión de la configuración

## Miembros del equipo (orden alfabético por apellido)

Escala 1–10 de esfuerzo/implicación (10 = mayor implicación)

| Miembro                                                                 | Implicación |
| ----------------------------------------------------------------------- | ----------- |
| [Angeles Burgos, Julia Virginia](https://github.com/Juliangeles)        | 10          |
| [Benito Merchán, Manuel Jesús](https://github.com/ManuelJBM)            | 10          |
| [Fernández Noguerol, Francisco](https://github.com/FranciscoFernandezN) | 10          |
| [Gutiérrez Arazo, Beatriz](https://github.com/BPP4634)                  | 10          |
| [Morán Corbacho, José Javier](https://github.com/josmorcor3)            | 10          |
| [Ramos Vargas, Alba](https://github.com/albramvar1)                     | 10          |

## Enlaces de interés

- [Repositorio de código](https://github.com/steamgames-hub/steamgames-hub-2/)
- [Sistema desplegado](https://steamgames-hub-2.onrender.com/)

## Enlace a la documentación

- [Documentación principal]()
- [Gestión del código fuente](https://github.com/steamgames-hub/steamgames-hub-2/blob/trunk/Doc/steamgames-hub-2/Gesti%C3%B3n_del_c%C3%B3digo_fuente.md)
- [Documentación Workflows CI/CD](https://github.com/steamgames-hub/steamgames-hub-2/blob/trunk/Doc/steamgames-hub-2/Workflows_CI_CD.md)

## Indicadores del Proyecto

(debe dejar enlaces a evidencias que permitan de una forma sencilla analizar estos indicadores, con gráficas y/o con enlaces)

| Miembro del equipo                                                      | Horas | Commits | LoC   | Test                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Issues                                                                                                       | Work Item                                                                                                                                                                                   | Dificultad     |
| ----------------------------------------------------------------------- | ----- | ------- | ----- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------- |
| [Angeles Burgos, Julia Virginia](https://github.com/Juliangeles)        | 64    | 12       | 1832   | 15[¹](https://github.com/steamgames-hub/steamgames-hub-2/commit/2982e67a8cba6eba1fa3f3228a6d875770c296cd)[²](https://github.com/steamgames-hub/steamgames-hub-2/commit/2f999774c0a563854969685c1b16b07f6480acb9)                                                                                                                                                                                                                                                                                                                                                           | [9](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3AJuliangeles)         | [WI 105 - Contador de descargas](https://github.com/EGCETSII/uvlhub/issues/105) <br>[WI 85 - Versionado mayor](https://github.com/EGCETSII/uvlhub/issues/85)</br>                           | L <br>H</br>   |
| [Benito Merchán, Manuel Jesús](https://github.com/ManuelJBM)            | 66    | 3       | 475   | 5[¹](https://github.com/steamgames-hub/steamgames-hub-2/commit/a48814893871d415d9d7144c23dd32f9745a62af)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | [5](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3AManuelJBM)           | [WI 68 - Borradores de dataset](https://github.com/EGCETSII/uvlhub/issues/68) <br>[WI 86 - Ver el historial de versiones de un dataset](https://github.com/EGCETSII/uvlhub/issues/86)</br>  | M <br>H</br>   |
| [Fernández Noguerol, Francisco](https://github.com/FranciscoFernandezN) | 67    | 18      | 1560  | 13[¹](https://github.com/steamgames-hub/steamgames-hub-2/tree/trunk/app/modules/fakenodo/tests)[²](https://github.com/steamgames-hub/steamgames-hub-2/commit/b8a43b1a109baeefffb0c488b9c5a0d4bc1383a8)[³](https://github.com/steamgames-hub/steamgames-hub-2/tree/trunk/app/modules/auth/tests)                                                                                                                                                                                                                                                                            | [9](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3AFranciscoFernandezN) | [WI 68 - Borradores de dataset](https://github.com/EGCETSII/uvlhub/issues/68) <br>[WI 85 - Versionado mayor](https://github.com/EGCETSII/uvlhub/issues/85)</br>                             | M <br>H</br>   |
| [Gutiérrez Arazo, Beatriz](https://github.com/BPP4634)                  | 66    | 21      | 2457  | 16[¹](https://github.com/steamgames-hub/steamgames-hub-2/commit/a2e512535ca146803bdd945ebdbbe7d2bc0ef75f)[²](https://github.com/steamgames-hub/steamgames-hub-2/commit/9d747217cfc7b5489b27cf73aeaa25532d1b104d)[³](https://github.com/steamgames-hub/steamgames-hub-2/commit/e5f4d86084420efc0cefa0daa4589224c758c800)[⁴](https://github.com/steamgames-hub/steamgames-hub-2/issues/74)                                                                                                                                                                                                                                                     | [14](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3ABPP4634)            | [WI 77 - Rol administrador](https://github.com/EGCETSII/uvlhub/issues/77) <br>[WI 85 - Versionado mayor](https://github.com/EGCETSII/uvlhub/issues/85)</br>                                 | M <br>H</br>   |
| [Morán Corbacho, José Javier](https://github.com/josmorcor3)            | 70    | 13      | 1183  | 12[¹](https://github.com/steamgames-hub/steamgames-hub-2/commit/993b3d72de9be700cd55349e8887b8d6c22ab867#diff-4aa1b4d692f28410d5e1f5946e9d974b1e7f083cbd5d2d4eff505eae48929491)[²](https://github.com/steamgames-hub/steamgames-hub-2/commit/5a45865909e926eeb0ecee19eb848df9b2edacc3#diff-8962a795efc9c990b985f29e4dc0ea3642312b841956bd7b782e426a88c29386)[³](https://github.com/steamgames-hub/steamgames-hub-2/commit/6d696fc5eb94fe62858f2a4d1905024c7098c12c)[⁴](https://github.com/steamgames-hub/steamgames-hub-2/commit/8194df01e59e5baa8001ee84bc0c9be9fef308b4) | [15](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3Ajosmorcor3)         | [WI 77 - Rol administrador](https://github.com/EGCETSII/uvlhub/issues/77) <br>[WI 86 - Ver el historial de versiones de un dataset](https://github.com/EGCETSII/uvlhub/issues/86)</br>      | M <br>H</br>   |
| [Ramos Vargas, Alba](https://github.com/albramvar1)                     | 71    | 17      | 14267 | 20[¹](https://github.com/steamgames-hub/steamgames-hub-2/commit/2f2877b7ae90291ba8e0f17b12b8d07e7551b177)[²](https://github.com/steamgames-hub/steamgames-hub-2/commit/e0b4676e2f9851504af9927c699750ddc76ad18c)[³](https://github.com/steamgames-hub/steamgames-hub-2/commit/5222703861477efac203c7b0e0dee91130d1bc4a)[⁴](https://github.com/steamgames-hub/steamgames-hub-2/commit/4aae0bce185d70fd6cce07e5826f1f91c2f33ce1)                                                                                                                                             | [13](https://github.com/steamgames-hub/steamgames-hub-2/issues?q=is%3Aissue%20assignee%3Aalbramvar1)         | [WI 76 - Verificación del email](https://github.com/EGCETSII/uvlhub/issues/76) <br>[WI 86 - Ver el historial de versiones de un dataset](https://github.com/EGCETSII/uvlhub/issues/86)</br> | L <br>H</br>   |
| TOTAL                                                                   | 343   | 73      | 21774 | 81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 65                                                                                                           | WIs realizados: 68 (borradores), 76 (verificación email), 77 (rol admin), 85 (versionado mayor), 86 (historial versiones), 105 (contador descargas)                                         | H(2)/M(2)/L(2) |

La tabla contiene la información de cada miembro del proyecto y el total de la siguiente forma:

- **Horas:** número de horas empleadas en el proyecto
- **[Commits:](https://github.com/steamgames-hub/steamgames-hub-2/graphs/contributors)** solo contar los commits hechos por miembros del equipo, no lo commits previos
- **[LoC (líneas de código):](https://github.com/steamgames-hub/steamgames-hub-2/graphs/contributors)** solo contar las líneas producidas por el equipo y no las que ya existían o las que se producen al incluir código de terceros
- **Test:** solo contar los test realizados por el equipo nuevos
- **Issues:** solo contar las issues gestionadas dentro del proyecto y que hayan sido gestionadas por el equipo
- **Work Item:** principal WI del que se ha hecho cargo el miembro del proyecto
- **Dificultad:** señalar el grado de dificultad en cada caso. Además, en los totales, poner cuántos se han hecho de cada grado de dificultad entre paréntesis.

## Integración con otros equipos

### [Steamgames-hub-1](https://github.com/steamgames-hub/steamgames-hub-1)

- **Lugar (commits de integración):** integración de su trabajo dentro de nuestro proyecto para unificar el desarrollo y disponer de una plataforma común.

  - [[datatype]hub / New dataset #6](https://github.com/steamgames-hub/steamgames-hub-2/commit/fd160acd1ace540975629a1b451ab7dbf0743cda)
  - [Two-factor authentication (2FA) #8](https://github.com/steamgames-hub/steamgames-hub-2/commit/7773d1bf795f1ec9c03a765f5ec47b59546bf792)
  - [Automatic dataset recommendations #9](https://github.com/steamgames-hub/steamgames-hub-2/commit/88f8cd6fe38fab46954e9535955cab75f99a1eca)
  - [Trending datasets #10](https://github.com/steamgames-hub/steamgames-hub-2/commit/395204cb8bb6d251a6b34279f81d2c4f9020d684)
  - [Advanced dataset search #11](https://github.com/steamgames-hub/steamgames-hub-2/commit/ee00437dece4cd44fa921495b3c5643b47891fd8)
  - [Recover my password #12](https://github.com/steamgames-hub/steamgames-hub-2/commit/3dd0737e3e4c49d8838d2b257ba738a2e4cac5aa)
  - [Metrics Dashboard #13](https://github.com/steamgames-hub/steamgames-hub-2/commit/afcd1a670a700e7f65e6a8ea6c30777ad5ea4e22)

## Resumen ejecutivo

### Contexto

En ciencia e ingeniería del software, los datasets son fundamentales porque sostienen la base empírica y facilitan la reproducibilidad, la colaboración y la transparencia. Sin embargo, en la práctica es frecuente encontrar repositorios privados, sistemas no disponibles o información perdida, corrupta o incompleta, lo que dificulta reutilizar y compartir conocimiento de forma fiable. UVLHUB surge como respuesta a este escenario: un repositorio centrado en modelos de características en formato UVL, alineado con principios de Ciencia Abierta.

En esta práctica se mantiene esa filosofía de centralizar y hacer accesible la información, pero aplicada a un dominio más cercano al usuario final: los videojuegos de Steam, desarrollando SteamGames-Hub como un hub para explorar y gestionar información y funcionalidades relacionadas con estos recursos de manera consistente.

### Objetivo

El objetivo fue establecer una base de trabajo común para el equipo, aplicando una gestión adecuada del código y del proceso de evolución del proyecto. Para ello, se preparó el sistema para que pudiera ejecutarse de forma consistente entre miembros del equipo y se trabajó con herramientas habituales del ciclo de vida del software (reproducibilidad, automatización y despliegue), dejando el proyecto listo para incorporar funcionalidades de forma colaborativa.

### Reproducibilidad

El sistema puede ejecutarse en tres modalidades, facilitando su uso en distintos equipos y sistemas operativos:

1. **Docker Compose:** permite levantar el proyecto con una configuración común para todo el equipo.
2. **Vagrant:** como alternativa basada en máquina virtual para aislar dependencias del host y estandarizar el entorno.
3. **Ejecución local:** instalando dependencias y configurando variables/servicios necesarios.

### Trabajo realizado

Se desarrollaron mejoras centradas en trazabilidad, control de acceso, calidad de datos y experiencia de uso, materializadas en los siguientes Work Items:

#### WI 105 - Contador de descargas

Se añadió un contador persistente de descargas por dataset (download_count), incrementándolo en cada descarga y exponiéndolo en la API y en la vista de detalle. Esto permite medir popularidad/uso de forma simple y aporta una métrica útil tanto para autores como para usuarios.

#### WI 85 - Versionado mayor (nuevas versiones con DOI/identificador)

Se habilitó la creación de versiones “mayores” ante cambios sustanciales (ficheros o metadatos relevantes), generando una nueva versión enlazada a la anterior y manteniendo un identificador conceptual estable que apunta a la última. Esto mejora trazabilidad, citación y reproducibilidad al conservar el histórico.

#### WI 68 - Borradores de dataset

Se implementó el estado de borrador para permitir guardar trabajo sin publicar ni sincronizar con servicios externos, y continuar más tarde. Con esto se evita publicar información incompleta y se mejora el flujo de trabajo del autor.

#### WI 86 - Historial y visualización de versiones

Se desarrolló la exploración del historial de versiones, diferenciando ediciones menores/mayores, destacando la última versión y permitiendo acceder a versiones antiguas. Además, se clarificó el concepto de DOI conceptual vs DOI específico por versión para citar correctamente.

#### WI 77 - Roles de administración

Se incorporó un sistema de roles (admin/curator/standard/guest) para gestionar permisos dentro de la plataforma. Esto refuerza el control de acceso y la gobernanza del contenido.

#### WI 76 - Verificación de email

Se añadió verificación de correo en el registro para asegurar que las cuentas corresponden a emails válidos. Esto reduce cuentas falsas y mejora la seguridad y confianza del sistema.

### Calidad

Se ampliaron las pruebas automáticas y se revisó la cobertura mediante herramientas de coverage, observándose una mejora respecto al punto de partida del proyecto. Como validación funcional, se comprobó que el sistema arranca y permite ejecutar flujos básicos de extremo a extremo: registro/login (incluyendo verificación de email), gestión de permisos/roles, trabajo con borradores, consulta de historial de versiones y descargas verificando la actualización del contador y su exposición en UI/API.

### Integración

Como parte del trabajo de coordinación, se realizó integración de aportaciones externas de steamgames-hub-1 dentro del repositorio común, unificando el desarrollo y evitando divergencias entre equipos. Esta integración incorporó funcionalidades relevantes (por ejemplo, autenticación reforzada, recuperación de contraseña, búsqueda avanzada, recomendaciones y paneles de métricas), dejando un único repositorio base para continuar el desarrollo. Adicionalmente, se dispone de un sistema desplegado accesible públicamente, lo que permite validar el comportamiento en un entorno desplegado y facilitar la revisión del estado del proyecto.

El sistema cuenta además con un despliegue público accesible en [steamgames-hub-2.onrender.com](https://steamgames-hub-2.onrender.com/), utilizado como evidencia de ejecución en entorno desplegado.

### Conclusión

Con esta práctica se deja el proyecto en un estado operativo y estable para el trabajo en equipo: entorno reproducible (Docker/Vagrant/local), funcionalidades principales implementadas mediante los Work Items descritos, validación mediante pruebas y verificación funcional, e integración consolidada en un único repositorio con despliegue accesible públicamente. De esta forma, el sistema queda listo para su evaluación y uso por el equipo.

## Descripción del sistema

Steamgames-Hub al haber tomado como base el proyecto de UVL-Hub, su base funcional radica de este, pero nosotros como equipo hemos mejorado el sistema añadiendo diversas features de las que se hablarán posteriormente. Steamgames-Hub esta levantado mediante el microframework de Flask y se compone además de varias API RESTs como son las correspondientes a la plataforma de repositorio abierto de Zenodo y el sistema de análisis de modelos de variabilidad (o Feature Models) Flamapy y un "local storage" con una base de datos gestionada por MariaDB. El sistema se encuentra desplegado en Docker, Vagrant, Render y por supuesto en local.

La arquitectura del sistema se dispone de forma modular y su núcleo lo conforma principalmente el módulo de dataset y el módulo de auth que controla el inicio de sesión, los roles y a que tiene acceso cada usuario, además de restringir las principales funcionalidades de los dataset si no estas registrado o has hecho login. En cuanto al funcionamiento y relación entre los distintos elementos y clases del sistema, se trabaja mediante peticiones HTTP que son procesadas por el servidor y este ejecutará las distintas funciones que posee siguiendo siempre la misma forma (independientemente del módulo ya que todos están creados con la misma plantilla): la petición HTTP se resume en una ruta o url, que proviene del html propio de la página y que será atendida por el archivo routes.py donde se recogen todas las posibles rutas a las que se puede acceder y a su vez este realizará una serie de procesos apoyados en el archivo services.py (archivo en el que se recogen una serie de funciones útiles y necesarias para el sistema) para responder a esa petición de manera satisfactoria. De la misma forma, service.py, se apoya en los archivos forms.py (archivo para el procesado de información a través de formularios) y repositories.py (archivo donde se procesan las queries y se maneja la información que le llega a la base de datos), este último sabiendo como enviar la información gracias al archivo models.py, quien es el que estructura toda la información del sistema y se encarga del manejo de las tablas de la base de datos. Tras esto podemos ver que los módulos estan organizados en 3 niveles: el nivel de vista o interfaz, que es el que recoge las peticiones mandadas por el usuario; el nivel de controladores, que son los que procesan estas peticiones y realizan las distintas funciones; y el nivel modelo, que es donde se procesan todos los datos y está directamente conectado con la base de datos.

Pasando ya la parte más específica del sistema desarrollado, veremos cúales han sido las implementaciones hechas por el grupo. Primero hablaremos de las features obligatorias y posteriormente de las seleccionadas por el equipo.

### MANDATORY FEATURES

Estas features fueron realizadas por equipo de Steamgames-Hub-1, pero son necesarias para la base del sistema:

 - **WI-103-Fakenodo - Fictitious service to simulate Zenodo**: Este work-item se trata de crear un servicio falso (un mock) que simule el comportamiento básico de la API de Zenodo para que así podamos trabajar y probar el funcionamiento de la supuesta integración de la API sin tener que depender del propio servicio de Zenodo. De manera más específica se requiere de el servicio simplemente pueda crear un registro que devuelva una supuesta respuesta diciendo que se ha subido bien, que pueda subir archivos individuales pertenecientes a los datasets y que se puedan ver las distintas versiones de los archivos. Además si se editan los metadatos de algun registro, se deberá mantener el anterior DOI, pero si se cambia o añade algún fichero y se publica, se deberá crear una nueva versión del registro.

 - **WI-104-Newdataset - Evolving uvlhub into a "[datatype]hub"**: Este work-item se trata de reestructurar el sistema de forma que ya no esté enfocado en datasets de tipo UVL, sino que ahora se admitan datasets de distintos tipos, como por ejemplo UML, BPM o el nuestro propio. Reestructurar el sistema significa cambiar los tipos de datasets y para ello se hará uso del base (BaseDataset) como guía, además para cada modelo de datos se tendrá que crear su propia lógica y cada módulo su propio workflow.

### SPECIFIC FEATURES

Las siguientes features son las elegidas por el equipo de Steamgames-Hub-2 y por tanto se decidión no realizar las mismas para tener un sistema conjunto más completo y complejo.

 - **WI-105 - Add download counter for datasets**: El objetivo de este work-item es poder ver cuantas veces ha sido descargado un dataset y para ello se deberá de aumentar en 1 el contador de descargas cada vez que se realice una. Para ello se tendrás que hacer:

    - Añadir un nuevo campo en el model de los dataset que sea el contador (incialmente a 0).
    - Incrementar el contador con cada descarga.
    - Mostrar este valor en los detalles del dataset.
    - Añadir un endpoint (/datasets/{id}/stats) que devuelva este número y otros estadísticas relevantes.

 - **WI-75 - Verification email**: Cada usuario al registrarse debe recibir un email de verificación en su cuenta para poder registrarse en el sistema. Para ello se deberá poder mandar el mensaje al correo generando un token y al verificarse, se checkeará que dicho token es correcto.

 - **WI-77 - Admin roles**: Los administradores deben de ser capaces de asignar roles a todos los usuarios para poder gestionar los permisos de la plataforma y deben poder gestionar todo el sistema. Para ello se deberá hacer:

    - Implementar los distintos roles en backend: Administrador (Acceso a todo el sistema), Curator (Notifican a los administradores de errores), Usuarios y Guests.
    - Mostrar el rol en la parte superior de la página.
    - Implementar en backend la operación de editar el perfil de un usuario.
    - Implementar en backend la operación de eliminar un dataset.
    - Implementar en frontend la operación de editar el perfil de un usuario.
    - Implementar en frontend la operación de eliminar un dataset.
    - Implementar en backend la operación de ascender o degradar los permisos de los usuarios.
    - Poder ver la lista de usuarios.
    - Implementar en backend la funcionalidad de notificar errores (Curators).
    - Implementar en frontend la funcionalidad de notificar errores (Curators).
    - Implementar en backend la funcionalidad de obtener las incidencias.
    - Implementar en frontend la funcionalidad de obtener las incidencias.
    - Implementar la funcionalidad de cerrar incidencias o reabrirlas.

 - **WI-68 - Draft dataset**: Un usuario debe poder guardar sus borradores de los datasets que quiera dejar y continuar más adelante, pero estos datasets no deben de ser visibles para el resto de usuarios. Para ello se deberá hacer:

    - En backend crear una propiedad de los datasets que nos permita saber que datasets son borradores.
    - Permitir en backend que se puedan eliminar los borradores.
    - Permitir en backend que se pueda editar un borrador.
    - Detectar en frontend que cuando se rellene un campo y abandones la pestaña actual te salte una confirmación para guardar un borrador del dataset que se esté rellenando.
    - Poder ver en un apartado la lista de borradores.
    - Crear una propiedad de los usuarios para que los borradores se guarden automáticamente y no pedir confirmación.
    - Dar la posibilidad de cambiar la preferencia de guardado automatico.
    - Crear en frontend la funcionalidad de editar los borradores y poder publicarlos.
    - Crear en frontend la funcionalidad de eliminar los borradores.

 - **WI-85 - Major versioning**: Se debe permitir realizar grandes cambios en tus datasets ya publicados, creando así una nueva versión de este y poder ver las anteriores. Para ello se deberá hacer:

    - Modificar el modelo de datos para que se admita el versionado.
    - Permitir editar tus datasets publicados.
    - Permitir añadir o quitar ficheros de un dataset publicado.
    - Permitir modificar los metadatos del dataset.
    - Conectar y trackear versiones anteriores del dataset.
    - Poder ver todas las versiones de los datasets en una timeline.

 - **WI-86 - Viewing versions of a dataset**: Se deber permitir ver a los usuarios los cambios realizados a los datasets a través de las distintas versiones, diferenciando entre versiones con cambios pequeños y grandes. Para ello se deberá hacer:

    - Crear en backend la diferenciación de versiones.
    - Ver esa diferenciación en la interfaz.
    - Crear en backend una lista de versiones.
    - Poder ver los detalles de las distintas versiones.

Con todo esto, el sistema ahora es mucho más completo, manejable y robusto.

## Visión global del proceso de desarrollo

Para visualizar mejor el flujo de trabajo, pongamos de ejemplo el caso de recibir una sugerencia de una nueva feature, sea la que sea. 

### Creación de la issue y reparto del trabajo

Lo primero que ocurriría sería recibir dicha sugerencia como una nueva issue. Para facilitar al resto de usuarios la creación de esta issue, tenemos algunas plantillas a su disposición: 

- **Task**: para tareas no técnicas del proyecto. Incluye apartados de descripción, objetivo, pasos a realizar y contexto adicional.  

- **Feature**: para tareas técnicas y de desarrollo. Incluye los siguientes apartados: 

    - Descripción técnica: puede presentarse como una historia de usuario o como una descripción detallada de la funcionalidad, especificando casos de uso y consideraciones especiales, como casos límite o valores nulos. 

    - Criterios de aceptación 

    - Subtareas: aunque este apartado está enfocado a un miembro del equipo para organizar su trabajo, también puede utilizarse para completar la descripción, ya que permite un mayor desglose del trabajo a realizar. 

    - Dependencias: tareas que están bloqueadas por esta tarea o que bloquean a la issue que se está creando. También se puede mencionar issues del grupo steamgames-hub-1 para saber que hay que tenerlo en cuenta (ya sea por solapamientos o por poder utilizar implementaciones suyas) o incluso librerías que podrían ser de ayuda. 

- **Bug report**: enfocado a usuarios de la aplicación, ya sea en desarrollo o en producción. Incluye los siguientes apartados: 

    - Descripción del bug: descripción general del bug, cuál es el fallo, dónde ocurre, etc. 

    - Para reproducirlo: pasos detallados para reproducir el bug. 

    - Comportamiento esperado 

    - Capturas de pantalla: siempre es recomendable añadir capturas y evidencias del bug. Puede ocurrir que el equipo no sea capaz de reproducir el bug pero estas capturas pueden ayudar a identificarlas si vuelven a ocurrir en el futuro.

Una vez creada esta issue, esta sería automáticamente añadida a un tablero con el estado 'Triage'. Si la issue es de tipo Feature o Task, se añadiría al tablero [Feature tracker](https://github.com/orgs/steamgames-hub/projects/2) mientras que si es de tipo Bug se añadiría al tablero [Bug tracker](https://github.com/orgs/steamgames-hub/projects/4). Nosotros como equipo de desarrollo decidiríamos si es un cambio razonable e interesante y, si es así, se pasaría al estado de 'Todo'. 

Veamos primero qué ocurriría si recibimos una issue de tipo Feature.

A partir de aquí, nuestra coordinadora de equipos (Beatriz Gutiérrez) hablaría con el equipo de steamgames-hub-1 para ver si hay funcionalidades en común que podamos reutilizar o bien conflictos con los que tengamos que tener cuidado. Luego, nuestro coordinador de trabajo (Javier Morán) crearía las subtareas para que estas sean atómicas y realizables por una sola persona en un tiempo razonable para favorecer la integración continua. Aunque las issues existentes relacionadas con los work-items tienen la dificultad por defecto de dicho work-item, independientemente de su dificultad real, toda nueva issue recibiría como mínimo dos etiquetas: una de prioridad y otra de dificultad.

La etiqueta de dificultad, al ser establecida a priori, puede no estar perfectamente ajustada a la dificultad real de la tarea, sin embargo, la etiqueta de prioridad siempre será exacta y vinculante. A partir de aquí, el equipo discutiría cómo repartirse el trabajo. La repartición de tareas se haría de forma colaborativa, decidiéndose en conjunto qué hace cada uno. 

### Desarrollo y automatización

Una vez una persona empiece con su tarea, esta se creará una rama específica llamada feature/tarea-xx, siendo xx el número de tarea establecido en el título de la issue, y movería la tarea al estado 'In progress'. Esta rama puede incluir más información para que la rama sea más reconocible, por ejemplo, feature/tarea-33-datos-en-despliegue.

Conforme se avance en la tarea y se hagan commits la integración y el despliegue continuos comenzarán. Aunque todos los workflows y cómo interactúan está detallado en el documento [Workflows CI CD](./Workflows_CI_CD.md), veremos a continuación qué pasa, aunque sea por encima.

1. **Testing**: ante todo push o pull request (al ser un proyecto de equipo hemos incluido este trigger), se realizarán workflows de testing, tanto con pytest como con selenium. De esta forma, nos aseguramos de que los tests se pasan o, al menos, de qué tests fallan y con qué cambios.

2. **Python lint**: igual que el anterior, tras cualquier push o pull request se realiza un análisis estático del código. Permite mantener la calidad del código en un nivel mínimo.

Una vez se finalice el desarrollo y se integre la rama feature/tarea-xx a la rama trunk, habrá otros workflows de integración continua.

3. **Codacy analysis**: tras cualquier push o pull request a trunk, main o bugfix, se hará un análisis del código.

4. **Despliegue de preproducción**: ante un push a trunk se realizará un [despliegue en render](https://steamgames-hub-2-trunk.onrender.com/) sólo si previamente se han pasado los tests de pytest. De esta forma aseguramos tener siempre un entorno de pruebas para usuarios piloto que no tenga bugs identificables por código estático.

5. **Merge automático a main y auto releases**: para automatizar y simplificar el desarrollo, hemos introducido además estos dos workflows. Por un lado, todo los lunes a las 00:00 se realiza un merge de trunk a main, de esta forma podemos centrarnos en el desarrollo sin tener que estar pendientes de cuándo integrar el código. Por otra parte, tenemos un workflow que crea una release cuando se realiza un push en main.

6. **Despliegues de producción**: una vez de hace un merge a main se actualizan los servicios de producción. Por un lado, tenemos un [despliegue en render](https://steamgames-hub-2.onrender.com/) como la publicación de la imagen en DockerHub.

### Conflictos

Cada uno trabaja en su tarea y, si cuando tiene que integrar la rama a trunk ve que hay conflictos que resolver, los resolverá en su rama de manera individual antes de subirlo a trunk.

Por otro lado, si son conflictos por integración de cambios del equipo steamgames-hub-1, será nuestro coordinador de trabajo (Javier Morán) que se encargará de resolverlo en local antes de subirlo a nuestro repositorio, ya que es él el que se encarga de coordinar el código de los dos equipos. Si necesitase ayuda para la resolución de conflictos, se lo comentaría al resto del equipo como si fuese una incidencia.

### Resolución de incidencias

En este caso, el flujo de trabajo cambiaría ligeramente. En función de la prioridad de dicho bug y de la carga de trabajo de cada miembro del equipo, alguno se autoasignaría directamente el bug y empezaría a trabajar en él, empezando por decidir si es necesario resolverlo, pasando la issue a 'Todo', o no. Aun así, depende el flujo de trabajo de si este bug se encuentra en producción o en preproducción.  

En el primer caso, un bug en producción, se resolvería dicho bug en la rama 'bugfix' y se pasaría automáticamente a main y a trunk. Sin embargo, si es un bug en preproducción, se seguiría el flujo de una issue cualquiera, con una rama específica y siendo incorporado de forma directa sólo a trunk, aunque llegaría finalmente a main con el merge automático semanal. 

## Entorno de desarrollo

### Configuración principal del equipo

Este proyecto puede funcionar en diversos entornos debido a la flexibilidad que proporciona, pero los miembros de este equipo han usado la siguiente configuración para su uso en local:

1. Un sistema operativo basado en Linux, en este caso, todo el equipo ha usado Ubuntu, entre las versiones 24.04.1 y 24.04.03 (última en el momento de la redacción de este documento)
2. Un IDE moderno, como es Visual Studio Code, en su versión `1.105.1`, junto con las extensiones que cada uno haya deseado. Debido a que ninguna extensión es **ESTRICTAMENTE NECESARIA**, no se detallarán en este apartado. Además, también se necesita acceso a una consola o CLI.
3. Una configuración de variables de entorno adecuadas para el funcionamiento en local, lo que **DEBE INCLUIR**:
- El nombre de la aplicación: `Steamgameshub.IO` en `FLASK_APP_NAME` y demás variables de entorno necesarias para una aplicación de flask, como son `FLASK_APP` y `FLASK_ENV`, en este caso con `app` y `development`, respectivamente.
- El dominio a usar cuando la aplicación arranque: `localhost:5000` en `DOMAIN`
- La configuración para conectarse con la base de datos de mariadb: puerto, nombre de la base de datos, usuario y contraseña. Estas variables se detallarán en el siguiente apartado.
- Una url ficticia para fakenodo en `FAKENODO_URL`, donde se ha usado `fakenodo.org`
- Las credenciales necesarias para poder enviar correos tanto para el 2FA como para la verificación del email y para almacenar ficheros en remoto en AWS (aunque esto último **NO INFLUYE PARA EL DESPLIGUE EN LOCAL**).
4. Una instalación limpia de Python 3.12.3, con su posterior instalación de dependencias con `pip install -r requirements.txt`
5. Una instalación y puesta en marcha del servicio de MariaDB consecuentes con las variables de entorno elegidas.

Una vez ejecutado todo este proceso, el equipo de trabajo ha trabajado en el proyecto siguiendo una serie de pasos:

1. Ejecutar migraciones (si existieran) con el servicio de MariaDB activado: `flask db upgrade`
2. Limpiar y poblar la base de datos: `rosemary db:reset` y `rosemary db:seed`
3. Arrancar la aplicación con `flask run --host=0.0.0.0 --debug --reload` y acceder a la url configurada en las variables de entorno.

### Correcto funcionamiento de la base de datos

Debido a que el sistema requiere una base de datos de MariaDB para funcionar en un sistema local, todo el equipo se ha instalado este servicio, configurándolo según la guía de [UVLHub](https://docs.uvlhub.io/installation/manual_installation), aunque a posteriori se le han hecho modificaciones en los nombres de las bases de datos para que sean `steamgameshubdb` y `steamgameshubdb_test` y por tanto, incluido esto en las variables de entorno de `MARIADB_DATABASE` y `MARIADB_TEST_DATABASE` respectivamente. El resto de variables de entorno y configuraciones se han dejado por defecto tal y como se dice en la guía.

### Otras configuraciones (con Docker y Vagrant)

Además, algunos integrantes del equipo han usado Docker para su entorno de desarrollo. Para esto, únicamente es necesario tener instalado Docker y corroborar que exista una variable de nombre `WORKING_DIR` apuntando a la carpeta `/app/` y quqe el nombre de la base de datos se llame `db`. Esto es debido a como están diseñados los Dockerfile del proyecto.

Una vez se verifique lo anterior, se puede arrancar el proyecto con Docker de la siguiente manera: `docker compose -f docker/docker-compose.dev.yml up -d `.

A su vez, el proyecto también se puede usar con una máquina virtual (Vagrant), pero ningún miembro la ha usado activamente. De todas formas, la configuración para poder usar Vagrant en muy sencilla, únicamente hay que verificar que la variable de entorno `WORKING_DIR` apunte a la carpeta `/vagrant/`. 

Una vez hecho esto, suponiendo que se tiene instalado Vagrant, Ansible y VirtualBox, un simple comando dentro de la carpeta `/vagrant/` arranca automaticamente la máquina virtual: `vagrant up`.

### API keys necesarias

Si bien el proyecto proporciona una serie de variables de entorno que en principio debieran ser "Plug-and-Play" en la raíz, el proyecto, tal y como se ha mencionado antes, requiere de API keys para funcionar, estas API keys (se incluyen en [este enlace](https://uses0-my.sharepoint.com/:f:/r/personal/albramvar1_alum_us_es/Documents/steamgames-hub-env?csf=1&web=1&e=SuQXbM) ya que no se pueden subir directamente a GitHub). Estas API keys son las siguientes:

- `AWS_ACCESS_KEY_ID` y `AWS_SECRET_ACCESS_KEY`, correspondientes con la conexión de AWS S3 para almacenar ficheros, siempre y cuando no se trate de un despliegue local. Claves que se complementan con `S3_BUCKET` y `S3_REGION`. 

- Para el email, las variables de entorno necesarias son:
    #### Para el 2FA
    - `FROM_EMAIL`, `MAIL_DEFAULT_SENDER` y `MAIL_USER`, con el correo usado como remitente, en este caso `noreply.steamgameshub@gmail.com`.
    - `MAIL_PASSWORD` y `MAIL_USERNAME`, con las claves necesarias para iniciar sesión en el correo anterior.
    - `MAIL_PORT`, `MAIL_USE_TLS` y `MAIL_PORT`

    #### Para la verficación del email
    - `SECRET_KEY`, `SECURITY_PASSWORD_SALT` y `SENDGRID_API_KEY`, con los valores que proporciona Sendgrid para poder enviar emails.

    Estas variables son muchas debido a que cada grupo ha integrado de una manera distinta el envío de correos.

### Puesta en marcha mejorada

Debido a que este proceso puede llegar a ser engorroso y, sobre todo, repetitivo si se instala en varias máquinas, se ha desarrollado una serie de scripts que facilitan y automatizan este proceso. Estos scripts son los denominados como `set-up-local.sh`, `set-up-docker.sh` y `set-up-vagrant.sh`. 

## Ejercicio de propuesta de cambio


El ejercicio que proponemos es añadir nuevas restricciones en el apartado de operar con roles de usuarios. Concretamente, no se permitirá que un admin pueda editar, borrar ni bajar de rango a otro admin. Sabiendo, por tanto, que si subimos de rango a un usuario para volverlo admin ya no podríamos editarlo, saltará un modal de confirmación antes de hacerlo.

Para llevar a cabo un cambio así, tendremos que llevar a cabo los siguientes pasos:
1. Crear la tarea (issue) asociada a esto en GitHub. Esto conllevará usar la plantilla apropiada, asignarle un responsable, asociarle etiquetas, asociarle un tipo y asociarle el tablero de "Feature tracker" colocando la tarea en Todo. Al crearla, supongamos que el id que se le genera es "#20"
2. Cuando vaya a abordarse la tarea, se crear una rama a partir de trunk a la que llamaremos feat/propuesta-de-cambio, y movemos la tarea de Todo a In Progress.
3. En la rama anterior, realizaremos la tarea. Para ello, es importante actualizar las ramas y cambiarnos a la que hemos creado con los siguientes comandos: 
```
>>>git fetch origin
>>>git checkout feat/propuesta-de-cambio
```
4. Realizaremos los cambios que sean necesarios, tanto en backend como en frontend.
5. En el módulo en el que se haya realizado la tarea (en este caso, auth), nos adentraremos en la carpeta "testa" para modificar el archivo "test_unit.py". Aquí, crearemos tests y modificaremos algunos de los ya existentes para que se adapten a la nueva funcionalidad, asegurándola ante cualquier cambio futuro. También se pueden crear tests de interfaz en test_selenium.py y tests de carga en locustfile.py si procede.
6. Subiremos los cambios con los comandos:
```
>>>git add .

>>>git commit -m "feat: Propuesta de cambios implementada

Se ha implementado la propuesta de cambios, la cual consistía en añadir nuevas restricciones en el apartado de operar con roles de usuarios. Concretamente, no se permitirá que un admin pueda editar, borrar ni bajar de rango a otro admin. Sabiendo, por tanto, que si subimos de rango a un usuario para volverlo admin ya no podríamos editarlo, saltará un modal de confirmación antes de hacerlo.

Closes: #20"

>>>git push
```
Nótese que:
- Al ser una nueva feature, el commit comienza con "feat"
- Al final del commit, escribimos el  tarea hace referencia o, como en este caso, cuál cierra. 
7. En GitHub, podremos observar cómo se activan los worksflows. Si algunos de estos falla, tendremos que revisar los cambios que hemos hecho para saber qué ha fallado y corregirlo.
8. Si está todo bien, nos cambiaremos en nuestra máquina a la rama trunk y nos traeremos los cambios:
```
>>>git checkout trunk
>>>git merge feat/propuesta-de-cambio
```
Si nada falla, hacemos "git push" y subimos los cambios a la rama trunk del repo. Si hay algún conflicto, lo resolveremos con cuidado para no romper ninguna funcionalidad.

9. Gracias a que la release está automatizada, se subirá automáticamente a la rama main cuando ocurra una release.
10. Movemos la tarea a Done y borramos la rama feat/propuesta-de-cambio.

## Conclusiones y trabajo futuro

### Conclusiones
- El proyecto ha alcanzado los objetivos funcionales planteados: gestión de usuarios, subida y descarga de ficheros, gestión de datasets y mecanismos básicos de verificación y 2FA. Las funcionalidades implementadas son coherentes con los requisitos y han sido validadas mediante tests unitarios e integración.
- La arquitectura modular facilita la extensión y el mantenimiento: cada módulo (auth, dataset, hubfile, profile, etc.) está claramente separado y documentado, lo que ha permitido trabajar en paralelo en varias partes del sistema.
- Se ha logrado un nivel de automatización (scripts de arranque, seeds, y pruebas locales) que acelera la puesta en marcha del entorno de desarrollo y unos workflows que permiten detectar bugs y errores temprano.
- La integración entre equipos ha sido complicada, sobre todo, por no tener claro desde el principio la manera de proceder entre nosotros.

### Trabajo futuro
- Calidad y pruebas: aumentar la cobertura de tests (unitarios, selenium, carga, etc.).
- Mejorar la interfaz gŕafica de la aplicación y unificar el estilo.
- CI/CD: añadir nuevos workflows y mejorar aquellos existentes, workflows de integración y despliegue automatizados.
- Rendimiento y escalabilidad: optimizar manejo de ficheros grandes (streaming, chunked uploads), mejorar cache y consultas a la base de datos, y añadir métricas.
- Robustez y experiencia de usuario: mejorar validaciones en formularios, mensajes de error más bonitos, accesibilidad y añadir idiomas (i18n).
- Documentación y onboarding: añadir guías más completas y mejorar el README.md

Estas propuestas priorizan la estabilidad, la seguridad y la facilidad de mantenimiento, dejando más de lado el aumento de las funcionalidades para el siguiente curso de desarrollo.
